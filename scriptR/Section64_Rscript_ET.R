######################################################################
# @TODO modify this parameter to change the version of the graph
######################################################################
fig6a_OAvsMDP<-TRUE
fig6b_PACEvsMDP<-FALSE
fig6c_HEURvsMDP<-FALSE
fig6d_OAvsHEUR<-FALSE
######################################################################
######################################################################


#pdf(file="OAvsHEURSamePath.pdf")
####################  CAS taille des probas en 1/10, \tau(3)>0
par(mfrow=c(1,2))
par(mar=c(5,4,4,2)+0.8,oma=rep(0.7,4))

MoyenneTaille<-c(4,3.9,3.8,3.7,3.6,3.5,3.4,3.3,3.2,3.1,3.8,3.7,3.6,3.5,3.4,3.3,3.2,3.1,3,3.6,3.5,3.4,3.3,3.2,3.1,3,2.9,3.4,3.3,3.2,3.1,3,2.9,2.8,2.7,3.2,3.1,3,2.9,2.8,2.7,3,2.9,2.8,2.7,2.6,2.5,2.8,2.7,2.6,2.5,2.4,2.6,2.5,2.4,2.4,2.3,2.2,3.7,3.6,3.5,3.4,3.3,3.2,3.1,3,2.9,3.5,3.4,3.3,3.2,3.1,3,2.9,2.8,3.3,3.2,3.1,3,2.9,2.8,2.7,2.6,3.1,3,2.9,2.8,2.7,2.6,2.5,2.9,2.8,2.7,2.6,2.5,2.4,2.7,2.6,2.5,2.4,2.3,2.5,2.4,2.3,2.3,2.2,2.1,3.4,3.3,3.2,3.1,3,2.9,2.8,2.7,3.2,3.1,3,2.9,2.8,2.7,2.6,2.5,3,2.9,2.8,2.7,2.6,2.5,2.4,2.8,2.7,2.6,2.5,2.4,2.3,2.6,2.5,2.4,2.3,2.2,2.4,2.3,2.2,2.1,2.2,2.1,2,2,1.9,1.8,3.1,3,2.9,2.8,2.7,2.6,2.5,2.4,2.9,2.8,2.7,2.6,2.5,2.4,2.3,2.7,2.6,2.5,2.4,2.3,2.2,2.5,2.4,2.3,2.2,2.1,2.3,2.2,2.1,2.1,2,1.9,2.8,2.7,2.6,2.5,2.4,2.3,2.6,2.5,2.4,2.3,2.2,2.1,2.4,2.3,2.2,2.1,2,2.2,2.1,2,2,1.9,1.8,2.5,2.4,2.3,2.2,2.1,2,2.3,2.2,2.1,2,1.9,2.1,2,1.9,1.9,1.8,1.7,2.2,2.1,2,1.9,2,1.9,1.8,1.8,1.7,1.6,1.9,1.8,1.7,1.7,1.6,1.5,1.6,1.5,1.4,1.3)
LorchvsMDPtau1eq1<-c(0.249843,0.262181,0.275146,0.290961,0.309404,0.330829,0.356058,0.385708,0.422649,0.466344,6.79759,7.26607,7.80644,8.43368,9.16726,10.0322,11.0401,12.1141,12.3516,15.303,16.5257,17.94,19.558,21.3649,23.2203,24.2147,22.0605,26.5618,28.8285,31.3652,33.9189,35.8062,35.6491,32.2639,0,41.0877,44.3469,47.1767,48.602,47.6132,95.1187,58.2212,61.0954,62.2176,61.1319,85.3866,0,76.1961,77.5269,56.3786,73.5291,0,95.4035,41.5441,58.8448,22.9201,39.9652,15.1715,4.04718,4.89935,5.86885,6.92416,8.06374,9.14958,10.1167,10.2455,9.18119,13.0185,14.5879,16.2196,18.0247,19.659,20.536,20.3777,18.1981,24.2858,26.6596,28.969,30.7148,31.0935,30.764,28.9039,0,38.1058,40.7164,42.34,42.707,42.6133,41.3948,0,53.2574,54.7764,55.3545,56.757,89.9827,0,68.5694,70.8166,73.4682,79.5355,0,89.0863,43.8107,65.9269,24.7807,47.3013,20.6484,9.12548,10.854,12.5672,14.0987,15.0523,15.7368,15.5511,13.7622,20.1119,22.2548,23.9869,24.7593,25.7586,25.3445,25.1582,0,32.7759,34.5778,35.5153,36.481,37.2604,38.4965,0,45.9877,47.1078,49.5605,51.2627,54.5306,0,61.0055,64.5171,68.7925,85.6656,0,81.5296,89.7488,71.4191,0,27.1649,50.4553,0,20.724,0,0,13.9751,15.6997,16.7486,17.7839,18.5451,18.7091,20.1353,0,25.2687,26.279,27.5844,28.7902,31.1904,33.3845,0,36.6369,38.6931,41.2098,45.6705,49.0933,0,51.4783,56.5229,62.6183,67.6971,0,74.1207,82.2468,71.9229,104.66,50.7307,21.3442,15.8436,16.2633,17.7678,20.1416,23.3123,25.2656,25.4368,28.213,32.6331,36.8423,39.7666,0,41.145,46.8345,52.3101,56.5822,0,62.7989,69.6776,79.4001,91.7665,108.253,21.9171,13.306,17.0658,21.0631,24.6355,27.2689,0,28.6576,33.6262,38.0211,45.3359,0,47.517,55.975,67.9279,77.1976,96.2814,22.281,14.8044,17.3424,23.3,31.4526,31.1782,40.0358,53.0969,60.5907,80.6125,114.461,15.0058,21.5728,34.1657,40.4543,60.2869,93.3345,21.2749,32.9869,64.0808,26.9166)
OAvsMDPtau1eq1<-c(0.114708,0.126986,0.14049,0.156401,0.173864,0.192226,0.212484,0.235869,0.264484,0.298344,0.155817,0.217772,0.298961,0.407541,0.567081,0.799746,1.14486,1.62894,1.85196,0.457867,0.74032,1.10701,1.59178,2.19905,2.91497,3.21037,1.80154,1.35192,1.99813,2.80837,3.62612,4.09046,3.43618,1.37012,0,2.85421,3.7916,4.45525,4.34504,3.05902,1.03573,4.19128,4.53934,3.99647,2.51167,0.790509,0,4.05022,3.3401,1.98526,0.59786,0,2.59635,1.50043,0.447747,1.00516,0.283811,0.14025,1.01353,1.48094,2.01055,2.5705,3.15071,3.62308,3.93529,3.51274,2.38104,1.953,2.61484,3.24704,3.9542,4.4622,4.35495,3.63067,2.0131,3.10113,3.94232,4.66338,4.91388,4.21621,3.40468,2.41272,0,4.37021,4.95931,4.84811,4.02885,3.40762,3.00023,0,4.74818,4.33492,3.54431,3.80446,3.88527,0,3.54913,3.59268,4.29103,5.30099,0,3.71938,4.82035,6.97322,5.12523,8.75714,9.83648,3.15495,4.10492,4.94654,5.54229,5.54373,5.29005,4.44164,2.79602,4.52292,5.32983,5.71827,5.26096,5.08848,4.10003,4.2041,0,5.39783,5.53303,5.01101,4.68232,4.68124,5.98586,0,4.99114,4.43502,5.0454,5.59336,8.17507,0,4.30664,5.37241,7.3253,10.7019,0,5.48559,9.18759,13.2996,0,10.7747,15.2384,0,16.0274,0,0,5.54713,6.21059,6.20439,6.11776,5.81012,5.18892,6.34317,0,6.03628,5.74158,5.67139,5.62808,6.88919,8.77571,0,5.05388,5.38323,6.23626,8.90369,11.6203,0,5.2534,7.68058,11.1452,14.6298,0,9.08395,13.2877,17.338,14.7772,20.8183,24.4984,6.38525,5.82044,6.17309,7.34796,9.34796,10.7664,5.00773,6.24287,8.93647,11.6435,13.904,0,7.23516,10.6264,14.0671,17.1651,0,12.1765,16.2097,22.6218,19.3612,29.007,35.0926,5.64854,8.34013,11.2339,13.7315,15.6765,0,9.49988,13.0162,16.099,21.9823,0,14.6577,20.7411,29.7933,25.63,38.879,48.3669,12.9984,15.176,20.5795,28.0602,18.9609,26.8533,38.5259,34.3547,51.2141,65.5504,27.5009,35.2597,49.3318,45.6634,66.9922,88.3541,68.9413,87.9126,120.014,175.793)
HEURvsMDPtau1eq1<-c(0.144563,0.150447,0.156102,0.163559,0.137051,0.152409,0.16913,0.192901,0.213766,0.239528,0.186901,0.203805,0.134746,0.166671,0.216553,0.166195,0.525648,0.765668,0.317778,0.161533,0.25132,0.382409,0.338279,1.25988,1.63308,1.68988,0.711743,0.449134,0.561447,0.740099,2.46657,2.51486,1.83825,0.432264,0,1.03769,1.22964,3.33395,2.86188,1.61594,0.268038,4.1199,3.82347,2.84524,1.35136,1.35922,0,3.97317,2.67122,4.29503,1.27378,0,7.59337,4.26566,1.23489,4.3127,1.2261,1.2504,1.33495,0.663334,0.894683,1.17889,0.458516,1.24895,1.3218,0.00104792,0.495121,0.832383,1.15747,0.551133,0.748407,2.05593,0.300921,0.856754,0,0.749081,0.952242,2.74844,0.750979,1.15578,0.337967,0,0,1.37627,1.20533,2.07102,0.749198,0.00135738,0.266493,0,2.90843,1.58274,0.111521,1.92875,0,0,0.928162,3.28824,1.5833,-0.00641045,0,3.02142,1.08171,0.30292,1.22749,0.338911,0.325208,1.44419,0.221509,0.444916,1.82083,0.34865,0.00251577,0.67089,0.448965,0.611571,0.875615,0.903204,0.0033234,0.730086,0,0.0376226,0,1.50351,0.862491,0.787917,0,0.534909,0,0,1.63378,0.120878,1.72579,0,0,0,2.58929,1.07964,0,0.330866,0,0.170888,1.0901,0.303,0,0.996589,0.221197,0,5.76462,0,0,0.00710614,1.39649,0.530424,0,0.51648,0,0.0368365,0,1.47832,0.387731,0.357177,0.647872,0,0.0339142,0,0.63666,1.43096,0,0,0.296205,0,0.616454,0,1.10534,0.182894,0,1.92621,0.988533,0.0655359,0.762908,6.14455,4.72453,1.43797,0,0.860448,0,0,0.167987,1.08843,0,0,1.04807,0.0555305,0,0,2.01908,0.876675,0,0,1.75582,0.653443,5.57891,9.04822,5.66382,4.38227,0.0889209,0,2.01448,0.748772,0.200134,0,2.89702,1.72859,0.446199,4.29775,0,1.37136,8.95684,5.13184,7.85412,5.44656,4.28209,4.0431,1.47353,8.03313,3.70507,10.6366,8.20618,4.89748,7.56026,5.47085,4.42198,12.6988,8.38559,4.86591,7.78415,5.71311,4.7448,14.1967,6.17446,5.36421,69.069)

LorchvsMDPtau3eq1<-c(0,0,0,0,0,0,0,0,0,0,7.58139,6.48927,5.40229,4.31408,3.23128,2.14526,1.0577,1.09307,1.10506,16.7088,15.5177,14.3255,13.1392,11.9493,10.7577,9.56509,8.38424,27.7199,26.4022,25.091,23.7759,22.4588,21.1411,19.8359,0,41.3394,39.8742,38.4044,36.9321,35.4593,0,58.5063,56.8417,55.1742,53.5063,0,0,81.017,79.0937,0,0,0,111.794,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8.50208,7.29661,6.09014,4.88956,3.68534,2.47942,1.27252,0.077521,18.7812,17.446,16.1173,14.7848,13.4502,12.1149,10.7925,0,31.5322,30.0452,28.5536,27.0593,25.5646,24.0838,0,47.6626,45.9699,44.2741,42.5781,0,0,68.9121,66.9513,64.9903,0,0,98.1459,0,0,0,0,0,0,0,0,0,0,0,0,0,9.49615,8.14279,6.79604,5.44531,4.09254,2.7391,1.39866,0,21.3139,19.8042,18.2898,16.7727,15.2551,13.7518,0,36.3186,34.5965,32.8713,31.1458,29.4365,0,56.1807,54.1804,52.1799,0,0,83.6868,81.3066,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10.8266,9.29354,7.75574,6.21518,4.67427,3.14768,0,24.6258,22.8734,21.1178,19.362,17.6226,0,42.9851,40.9437,38.9024,36.8799,0,68.5829,66.1446,0,106.585,0,0,0,0,0,0,0,0,12.5057,10.7219,8.93474,7.14749,5.37684,0,29.229,27.1449,25.061,22.9961,0,52.7084,50.209,47.7322,87.9316,84.839,0,0,0,0,0,0,0,14.9481,12.8197,10.6915,8.58277,0,36.0912,33.5278,30.9877,68.1605,64.9684,0,0,0,0,0,18.5438,15.9128,13.3057,47.0008,43.7022,95.5167,0,0,0,24.3195,20.9067,66.6258,0,0,34.8274,0)
OAvsMDPtau3eq1<-c(0,0,0,0,0,0,0,0,0,0,6.49833,5.40622,4.31924,3.23102,2.14823,1.0622,-0.0253569,0,0,14.3219,13.1307,11.9386,10.7522,9.56229,8.37069,7.17811,5.99726,23.7599,22.4422,21.131,19.8159,18.4988,17.1811,15.876,0,35.4337,33.9686,32.4988,31.0265,29.5537,28.0946,50.1483,48.4837,46.8161,45.1482,43.496,0,69.4431,67.5199,65.5965,63.6908,0,95.8234,93.5515,91.3005,133.901,131.153,192.961,7.66714,7.75263,7.83983,7.92906,8.01982,8.11298,8.20854,8.30644,8.40544,15.6984,14.4929,13.2864,12.0859,10.8816,9.67572,8.46881,7.27381,25.4102,24.075,22.7464,21.4138,20.0792,18.744,17.4215,0,37.457,35.97,34.4784,32.9841,31.4894,30.0086,0,52.696,51.0033,49.3075,47.6114,45.9313,0,72.7709,70.8101,68.8491,66.9063,0,100.391,98.0663,95.7632,140.61,137.784,203.814,17.1246,17.3365,17.5534,17.7747,18.0024,18.2365,18.4767,18.7205,27.1249,25.7716,24.4248,23.0741,21.7213,20.3679,19.0274,0,39.5653,38.0555,36.5411,35.024,33.5065,32.0031,0,55.3613,53.6392,51.914,50.1885,48.4792,0,76.2714,74.271,72.2706,70.2887,0,105.23,102.849,100.491,0,147.79,144.88,0,215.623,0,0,28.8788,29.2805,29.6914,30.1153,30.5523,31.0016,31.4597,0,41.7297,40.1967,38.6589,37.1184,35.5774,34.0509,0,58.1099,56.3574,54.6018,52.846,51.1066,0,79.9011,77.8598,75.8185,73.796,0,110.287,107.849,105.433,155.374,152.376,228.334,43.9637,44.6585,45.3781,46.1234,46.8922,47.6802,60.9574,59.1736,57.3864,55.5991,53.8285,0,83.6825,81.5984,79.5145,77.4496,0,115.6,113.101,110.624,163.445,160.352,242.142,63.8972,65.0783,66.3075,67.5813,68.893,0,87.6113,85.4829,83.3546,81.2459,0,121.166,118.603,116.063,172.006,168.814,257.066,91.7237,93.7629,95.8898,98.0957,127.044,124.413,121.806,181.17,177.872,273.421,133.261,136.953,140.821,191.004,187.591,291.397,201.545,208.905,311.177,332.859)
HEURvsMDPtau3eq1<-c(0,0,0,0,0,0,0,0,0,0,6.49833,5.40622,4.31924,3.23102,2.14823,1.0622,-0.0253569,0,0,14.3219,13.1307,11.9386,10.7522,9.56229,8.37069,0,0,23.7599,22.4422,21.131,19.8159,0,0,0,0,35.4337,33.9686,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7.66714,7.75263,7.83983,7.92906,8.01982,8.11298,8.20854,0,0,15.6984,14.4929,13.2864,12.0859,10.8816,2.47942,1.27252,0,25.4102,24.075,22.7464,14.7848,13.4502,12.1149,0,0,37.457,30.0452,28.5536,27.0593,0,0,0,47.6626,45.9699,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.1246,17.3365,17.5534,17.7747,0,0,0,0,27.1249,25.7716,6.79604,5.44531,4.09254,2.7391,0,0,21.3139,19.8042,18.2898,16.7727,15.2551,0,0,36.3186,34.5965,32.8713,0,0,0,56.1807,0,0,0,0,0,0,0,0,0,0,0,0,0,0,28.8788,0,0,0,0,0,0,0,10.8266,9.29354,7.75574,6.21518,4.67427,0,0,24.6258,22.8734,21.1178,0,0,0,42.9851,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12.5057,10.7219,8.93474,7.14749,5.37684,0,29.229,27.1449,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14.9481,12.8197,10.6915,0,0,36.0912,0,0,0,0,0,0,0,0,0,18.5438,15.9128,13.3057,47.0008,0,0,0,0,0,24.3195,0,0,0,0,34.8274,0)

x<-OAvsMDPtau1eq1/100
y<-HEURvsMDPtau1eq1/100
sol<-(x-y)/(y+1)
OAvsHeurtau1eq1<-sol*100

x<-OAvsMDPtau3eq1/100
y<-HEURvsMDPtau3eq1/100
sol<-(x-y)/(y+1)
OAvsHeurtau3eq1<-sol*100

if (fig6a_OAvsMDP) {
  OAvsMDP<-OAvsMDPtau1eq1
  LorchvsMDP<-OAvsMDPtau3eq1
  max_valtau1<-180
  max_valtau3<-350
} else if (fig6b_PACEvsMDP) {
  OAvsMDP<-LorchvsMDPtau1eq1
  LorchvsMDP<-LorchvsMDPtau3eq1
  max_valtau1<-150
  max_valtau3<-150
} else if (fig6c_HEURvsMDP) {
  OAvsMDP<-HEURvsMDPtau1eq1
  LorchvsMDP<-HEURvsMDPtau3eq1
  max_valtau1<-80
  max_valtau3<-80
} else if (fig6d_OAvsHEUR) {
  OAvsMDP<-OAvsHeurtau1eq1
  LorchvsMDP<-OAvsHeurtau3eq1
  max_valtau1<-180
  max_valtau3<-350
}

borne<-(max(MoyenneTaille)-min(MoyenneTaille))*10
iterVal<-NULL
for (i in 0:borne) {
  iterVal<-c(iterVal,(13+i)/10)
}
ValueMin<-NULL;ValueMax<-NULL;ValueMean<-NULL;
for (i in iterVal) {
  print(i)
  print(which(MoyenneTaille==i))
  ValueMin<-c(ValueMin,min(LorchvsMDP[which(MoyenneTaille==i)]));
  ValueMax<-c(ValueMax,max(LorchvsMDP[which(MoyenneTaille==i)]));
  ValueMean<-c(ValueMean,mean(LorchvsMDP[which(MoyenneTaille==i)]));
}

borne<-(max(MoyenneTaille)-min(MoyenneTaille))*10
iterVal<-NULL
for (i in 0:borne) {
  iterVal<-c(iterVal,(13+i)/10)
}
ValueMinOA<-NULL;ValueMaxOA<-NULL;ValueMeanOA<-NULL;
for (i in iterVal) {
  print(i)
  print(which(MoyenneTaille==i))
  ValueMinOA<-c(ValueMinOA,min(OAvsMDP[which(MoyenneTaille==i)]));
  ValueMaxOA<-c(ValueMaxOA,max(OAvsMDP[which(MoyenneTaille==i)]));
  ValueMeanOA<-c(ValueMeanOA,mean(OAvsMDP[which(MoyenneTaille==i)]));
}

tailleLegend<-0.9;
# 180 pour OA, 150 pour Lorch, 80 Heuristic,xaxs = "i",yaxs = "i"
# main="(OA) vs (Heur)\n inter-arrival time = 1",
plot(OAvsMDP~MoyenneTaille,ylim=c(0,max_valtau1),pch=".",
     cex.main=tailleLegend+0.5,cex.lab =tailleLegend, col="black", cex.axis=1.5, cex =2.5,lwd = 1, 
     ylab="Over-consumption (%)", xlab="Size mean depending on their probabilities")
#cols<-c("black");
#legend("topright", c("OA vs MDP"),pch=c(4,4),col=cols[1:6],bty="o",cex=tailleLegend,x.intersp = 1.5, y.intersp = 1.5,text.width=0.8,inset=c(0.02,0.02*0.70), pt.lwd=4)
lines(iterVal,ValueMaxOA,col='green')
lines(iterVal,ValueMinOA,col='blue')
lines(iterVal,ValueMeanOA,col='red')
cols<-c("green","red","blue");
legend("topright", c("max","mean","min"),col=cols[1:6],bty="n",cex=tailleLegend,
       x.intersp = 0.4, y.intersp = 0.75,text.width=0.5,inset=c(0.01,0.01*1.41), pt.lwd=4, lty=1,lwd=2)

# 350 pour OA, 150 pour Lorch, 80 Heuristic, xaxs = "i",yaxs = "i"
# main="(OA) vs (Heur)\n inter-arrival time = 3",
plot(LorchvsMDP~MoyenneTaille, ylim=c(0,max_valtau3),col="black",
     cex.main=tailleLegend+0.5,pch=".", cex.lab =tailleLegend, cex.axis=1.5, cex =2.5,lwd = 1, 
     ylab="Over-consumption (%)", xlab="Size mean depending on their probabilities")
#cols<-c("black");
#legend("topright", c("Lorch vs MDP"),pch=c(4,4),col=cols[1:6],bty="o",cex=tailleLegend,x.intersp = 1.5, y.intersp = 1.5,text.width=1,inset=c(0.02,0.02*0.70), pt.lwd=4)
lines(iterVal,ValueMax,col='green')
lines(iterVal,ValueMin,col='blue')
lines(iterVal,ValueMean,col='red')
#cols<-c("green","blue","red");
#legend("topright", c("max","mean","min"),pch=c(4,19),col=cols[1:6],bty="o",cex=tailleLegend,x.intersp = 1.5, y.intersp = 1.5,text.width=0.7,inset=c(0.05,0.05*1.41), pt.lwd=4)
cols<-c("green","red","blue");
legend("topright", c("max","mean","min"),col=cols[1:6],bty="n",cex=tailleLegend,
       x.intersp = 0.4, y.intersp = 0.75,text.width=0.5,inset=c(0.01,0.01*1.41), pt.lwd=4, lty=1,lwd=2)

print("MDP mean of Min/Mean/Max (blue/red/green) tau=3")
print(min(ValueMin))
print(mean(ValueMean))
print(max(ValueMax))
print("OA mean of Min/Mean/Max (blue/red/green) tau=1")
print(min(ValueMinOA))
print(mean(ValueMeanOA))
print(max(ValueMaxOA))
print("Percentage of simu where HEUR better than OA for tau=1")
print(length(which(OAvsHeurtau1eq1>=0))/length(OAvsHeurtau1eq1))
print("Percentage of simu where HEUR better than OA for tau=3")
print(length(which(OAvsHeurtau3eq1>=0))/length(OAvsHeurtau3eq1))
#dev.off()
